const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/katex.B82Si5CG.css","_astro/fancybox.DRe9SoLl.css"])))=>i.map(i=>d[i]);
import{_ as b}from"./preload-helper.BlTxHScW.js";import{p as M,u as P}from"./url-utils.Divo5N3w.js";import{c as q,D as H}from"./constants.D4k-FYC3.js";import{w as O,a as x}from"./config.C6HpbU8S.js";import"./zh_TW.12WzXWON.js";const L=35,C=30,z=L+C,d=(e,n)=>window.setTimeout(e,n),T=!!document.getElementById("banner-wrapper");async function F(){try{let e=function(t,o){document.addEventListener("click",async a=>{let i=a.target;if(i instanceof Node){for(let r of o){let c=document.getElementById(r);if(c==i||c?.contains(i))return}await n.closePanel(t)}})};const{panelManager:n}=await b(async()=>{const{panelManager:t}=await import("./panel-manager.BYknToDe.js");return{panelManager:t}},[]);return e("display-setting",["display-setting","display-settings-switch"]),e("nav-menu-panel",["nav-menu-panel","nav-menu-switch"]),e("search-panel",["search-panel","search-bar","search-switch"]),e("mobile-toc-panel",["mobile-toc-panel","mobile-toc-switch"]),e("wallpaper-mode-panel",["wallpaper-mode-panel","wallpaper-mode-switch"]),n}catch(e){return console.error("Failed to initialize panel manager:",e),null}}F();function N(){document.querySelectorAll(".katex-display:not([data-scrollbar-initialized])").forEach(n=>{if(!n.parentNode)return;const t=document.createElement("div");t.className="katex-display-container",n.parentNode.insertBefore(t,n),t.appendChild(n),t.style.cssText=`
            overflow-x: auto;
            scrollbar-width: thin;
            scrollbar-color: rgba(0,0,0,0.3) transparent;
        `;const o=document.createElement("style");o.textContent=`
            .katex-display-container::-webkit-scrollbar {
                height: 6px;
            }
            .katex-display-container::-webkit-scrollbar-track {
                background: transparent;
            }
            .katex-display-container::-webkit-scrollbar-thumb {
                background: rgba(0,0,0,0.3);
                border-radius: 3px;
            }
            .katex-display-container::-webkit-scrollbar-thumb:hover {
                background: rgba(0,0,0,0.5);
            }
        `,document.head.querySelector("style[data-katex-scrollbar]")||(o.setAttribute("data-katex-scrollbar","true"),document.head.appendChild(o)),n.setAttribute("data-scrollbar-initialized","true")})}function A(){requestAnimationFrame(()=>{const e=document.getElementById("banner");e&&e.classList.remove("opacity-0","scale-105");const n=document.querySelector('.block.lg\\:hidden[alt="Mobile banner image of the blog"]');n&&!document.getElementById("banner-carousel")&&(n.classList.remove("opacity-0","scale-105"),n.classList.add("opacity-100")),document.getElementById("banner-carousel")&&R()})}function R(){const e=document.querySelectorAll(".carousel-item"),n=window.innerWidth<1024,t=Array.from(e).filter(o=>n?o.querySelector(".block.lg\\:hidden"):o.querySelector(".hidden.lg\\:block"));if(t.length>1&&!x.banner.carousel?.enable){e.forEach((i,r)=>{i.classList.add("opacity-0","scale-110"),i.classList.remove("opacity-100","scale-100")});const o=Math.floor(Math.random()*t.length),a=t[o];a.classList.add("opacity-100","scale-100"),a.classList.remove("opacity-0","scale-110");return}if(t.length>1&&x.banner.carousel?.enable){let o=function(s){const p=t[i];p.classList.remove("opacity-100","scale-100"),p.classList.add("opacity-0","scale-110"),i=s;const f=t[i];f.classList.add("opacity-100","scale-100"),f.classList.remove("opacity-0","scale-110")},a=function(){clearInterval(c),c=setInterval(()=>{if(!l){const s=(i+1)%t.length;o(s)}},r*1e3)},i=0;const r=x.banner.carousel?.interval||6;let c,l=!1,m=0,y=0,w=!1;const u=document.getElementById("banner-carousel");e.forEach(s=>{s.classList.add("opacity-0","scale-110"),s.classList.remove("opacity-100","scale-100")}),t.length>0&&(t[0].classList.add("opacity-100","scale-100"),t[0].classList.remove("opacity-0","scale-110")),u&&"ontouchstart"in window&&(u.addEventListener("touchstart",s=>{m=s.touches[0].clientX,y=s.touches[0].clientY,w=!1,l=!0,clearInterval(c)},{passive:!0}),u.addEventListener("touchmove",s=>{if(!m||!y)return;const p=Math.abs(s.touches[0].clientX-m),f=Math.abs(s.touches[0].clientY-y);p>f&&p>30&&(w=!0,s.preventDefault())},{passive:!1}),u.addEventListener("touchend",s=>{if(!m||!y||!w){l=!1,a();return}const p=s.changedTouches[0].clientX,f=m-p;if(Math.abs(f)>50)if(f>0){const I=(i+1)%t.length;o(I)}else{const I=(i-1+t.length)%t.length;o(I)}m=0,y=0,w=!1,l=!1,a()},{passive:!0})),u&&(u.addEventListener("mouseenter",()=>{l=!0,clearInterval(c)}),u.addEventListener("mouseleave",()=>{l=!1,a()})),a()}}function B(){const e=O?.sakura;!e||e.enable}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",B):B();let g=[],h;function E(){document.querySelector(".katex")&&b(()=>Promise.resolve({}),__vite__mapDeps([0]))}async function v(){const e=".custom-md img, #post-cover img, .moment-images img",n=".moment-images a[data-fancybox]",t="[data-fancybox]:not(.moment-images a)";if(!(document.querySelector(e)||document.querySelector(n)||document.querySelector(t))||(h||(h=(await b(()=>import("./index.D26FdS83.js"),[])).Fancybox,await b(()=>Promise.resolve({}),__vite__mapDeps([1]))),g.length>0))return;const a={Thumbs:{autoStart:!0,showOnStart:"yes"},Toolbar:{display:{left:["infobar"],middle:["zoomIn","zoomOut","toggle1to1","rotateCCW","rotateCW","flipX","flipY"],right:["slideshow","thumbs","close"]}},animated:!0,dragToClose:!0,keyboard:{Escape:"close",Delete:"close",Backspace:"close",PageUp:"next",PageDown:"prev",ArrowUp:"next",ArrowDown:"prev",ArrowRight:"next",ArrowLeft:"prev"},fitToView:!0,preload:3,infinite:!0,Panzoom:{maxScale:3,minScale:1},caption:!1};h.bind(e,{...a,groupAll:!0,Carousel:{transition:"slide",preload:2}}),g.push(e),h.bind(n,{...a,source:i=>i.getAttribute("data-src")||i.getAttribute("href")}),g.push(n),h.bind(t,a),g.push(t)}function X(){h&&(g.forEach(e=>{h.unbind(e)}),g=[])}const D=()=>{window.swup.hooks.on("link:click",()=>{if(document.documentElement.style.setProperty("--content-delay","0ms"),T){const e=document.getElementById("navbar-wrapper");if(e&&document.body.classList.contains("lg:is-home")){const n=window.innerHeight*(L/100)-88;document.documentElement.scrollTop>=n&&e.classList.add("navbar-hidden")}}}),window.swup.hooks.on("content:replace",()=>{if(v(),E(),N(),document.getElementById("toc-wrapper")!==null){const o=document.querySelector("table-of-contents");o&&typeof o.init=="function"&&d(()=>{o.init()},100),typeof window.mobileTOCInit=="function"&&d(()=>{window.mobileTOCInit()},100)}const t=document.getElementById("navbar");t&&t.getAttribute("data-transparent-mode")==="semifull"&&typeof window.initSemifullScrollDetection=="function"&&window.initSemifullScrollDetection()}),window.swup.hooks.on("visit:start",e=>{X();const n=document.querySelector("body"),t=M(e.to.url,P("/"));n&&(t?n.classList.add("lg:is-home"):n.classList.remove("lg:is-home"));const o=document.querySelector(".banner-text-overlay");o&&(t?o.classList.remove("hidden"):o.classList.add("hidden"));const a=document.getElementById("navbar");a&&(a.setAttribute("data-is-home",t.toString()),a.getAttribute("data-transparent-mode")==="semifull"&&typeof window.initSemifullScrollDetection=="function"&&window.initSemifullScrollDetection());const i=document.getElementById("banner-wrapper"),r=document.querySelector(".absolute.w-full.z-30");i&&r&&(t?(d(()=>{i.classList.remove("mobile-hide-banner")},100),d(()=>{r.classList.remove("mobile-main-no-banner")},150)):(i.classList.add("mobile-hide-banner"),d(()=>{r.classList.add("mobile-main-no-banner")},100)));const c=document.getElementById("page-height-extend");c&&c.classList.remove("hidden");let l=document.getElementById("toc-wrapper");l&&l.classList.add("toc-not-ready")}),window.swup.hooks.on("page:view",()=>{const e=document.getElementById("page-height-extend");e&&e.classList.remove("hidden"),window.scrollTo({top:0,behavior:"instant"});const t=(localStorage.getItem("theme")||q)===H,o=t?"github-dark":"github-light",a=document.documentElement.getAttribute("data-theme"),i=document.documentElement.classList.contains("dark");(a!==o||i!==t)&&requestAnimationFrame(()=>{a!==o&&document.documentElement.setAttribute("data-theme",o),i!==t&&(t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"))}),d(()=>{if(document.getElementById("tcomment")){const r=new CustomEvent("mizuki:page:loaded",{detail:{path:window.location.pathname,timestamp:Date.now()}});document.dispatchEvent(r),console.log("Layout: 触发 mizuki:page:loaded 事件，路径:",window.location.pathname)}},300)}),window.swup.hooks.on("visit:end",e=>{d(()=>{const n=document.getElementById("page-height-extend");n&&n.classList.add("hidden");const t=document.getElementById("toc-wrapper");t&&t.classList.remove("toc-not-ready")},200)})};window?.swup?.hooks?(v(),E(),D()):(document.addEventListener("swup:enable",D),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{v(),E()}):(v(),E()));let k=document.getElementById("back-to-top-btn"),_=document.getElementById("toc-wrapper"),S=document.getElementById("navbar-wrapper");function W(e,n){let t;return function(){const o=arguments,a=this;t||(e.apply(a,o),t=!0,d(()=>t=!1,n))}}function V(){const e=document.documentElement.scrollTop,n=window.innerHeight*(L/100);requestAnimationFrame(()=>{if(k&&(e>n?k.classList.remove("hide"):k.classList.add("hide")),T&&_&&(e>n?_.classList.remove("toc-hide"):_.classList.add("toc-hide")),T&&S){const o=document.body.classList.contains("lg:is-home")&&window.innerWidth>=1024?z:L,a=window.innerHeight*(o/100)-88;e>=a?S.classList.add("navbar-hidden"):S.classList.remove("navbar-hidden")}})}window.onscroll=W(V,16);window.onresize=()=>{let e=Math.floor(window.innerHeight*(C/100));e=e-e%4,document.documentElement.style.setProperty("--banner-height-extend",`${e}px`)};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",async()=>{A();try{await b(()=>import("./panel-manager.BYknToDe.js"),[]),console.log("Panel manager initialized")}catch(e){console.error("Failed to initialize panel manager:",e)}}):(A(),(async()=>{try{await b(()=>import("./panel-manager.BYknToDe.js"),[]),console.log("Panel manager initialized")}catch(e){console.error("Failed to initialize panel manager:",e)}})());
