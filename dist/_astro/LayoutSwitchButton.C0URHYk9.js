import{o as p,i as z,s as C,b as I}from"./lifecycle.BUKLqami.js";import{c as q,f as H,a as u,p as x,b as M,h as d,g as a,m as h,k as B,u as T,d as V,e as j,r as F,t as W,o as A,a2 as b}from"./utils.C6YlWNI1.js";import{i as y}from"./if.AUn_gUq8.js";import{p as D}from"./props.BdyWAK-0.js";import{s as G,a as m}from"./config.C6HpbU8S.js";/* empty css                        */var J=b('<svg class="w-5 h-5 icon-transition svelte-8vwu4q" fill="currentColor" viewBox="0 0 24 24"><path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z" class="svelte-8vwu4q"></path></svg>'),K=b('<svg class="w-5 h-5 icon-transition svelte-8vwu4q" fill="currentColor" viewBox="0 0 24 24"><path d="M3 3h7v7H3V3zm0 11h7v7H3v-7zm11-11h7v7h-7V3zm0 11h7v7h-7v-7z" class="svelte-8vwu4q"></path></svg>'),N=V('<button aria-label="切换文章列表布局"><!></button>');function Y(_,g){M(g,!1);let s=D(g,"currentLayout",12,"list"),r=h(!1),i=h(!1),l=h(!1);G.position;function v(){d(i,window.innerWidth<1200),a(i)&&s("list")}p(()=>{d(r,!0),v();const e=localStorage.getItem("postListLayout");return e&&(e==="list"||e==="grid")&&s(e),window.addEventListener("resize",v),()=>{window.removeEventListener("resize",v)}});function S(){if(!a(r)||a(i)||a(l))return;d(l,!0),s(s()==="list"?"grid":"list"),localStorage.setItem("postListLayout",s());const e=new CustomEvent("layoutChange",{detail:{layout:s()}});window.dispatchEvent(e),setTimeout(()=>{d(l,!1)},500)}p(()=>{const e=t=>{s(t.detail.layout)};return window.addEventListener("layoutChange",e),()=>{window.removeEventListener("layoutChange",e)}}),p(()=>{const e=o=>{s(o.detail.layout)},t=()=>{setTimeout(()=>{console.log("Swup event - syncing layout state");const o=localStorage.getItem("postListLayout");if(o&&(o==="list"||o==="grid"))s(o);else{const w=m.postListLayout.defaultMode;s(w)}},200)};window.addEventListener("layoutInit",e);function c(){if(typeof window<"u"&&window.swup){const o=window.swup;o.hooks.on("content:replace",t),o.hooks.on("page:view",t),o.hooks.on("animation:in:end",t),console.log("Swup button listeners registered")}else window.addEventListener("popstate",t),console.log("Fallback button listeners registered")}return setTimeout(c,200),()=>{if(window.removeEventListener("layoutInit",e),typeof window<"u"&&window.swup){const o=window.swup;o.hooks.off("content:replace",t),o.hooks.off("page:view",t),o.hooks.off("animation:in:end",t)}else window.removeEventListener("popstate",t)}}),z();var L=q(),k=H(L);{var E=e=>{var t=N(),c=j(t);{var o=n=>{var f=J();u(n,f)},w=n=>{var f=K();u(n,f)};y(c,n=>{s()==="list"?n(o):n(w,!1)})}F(t),W(()=>{C(t,1,`btn-plain scale-animation rounded-lg h-11 w-11 active:scale-90 flex items-center justify-center theme-switch-btn ${a(l)?"switching":""}`,"svelte-8vwu4q"),t.disabled=a(l),I(t,"title",s()==="list"?"切换到网格模式":"切换到列表模式")}),A("click",t,S),u(e,t)};y(k,e=>{a(r),B(m),a(i),T(()=>a(r)&&m.postListLayout.allowSwitch&&!a(i))&&e(E)})}u(_,L),x()}export{Y as default};
